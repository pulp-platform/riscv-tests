# See LICENSE for license details.

#*****************************************************************************
# p.bset
#-----------------------------------------------------------------------------
#
# Test p.bset instruction.
# 
#

#include "riscv_test.h"
#include "test_macros.h"

RVTEST_RV32U
RVTEST_CODE_BEGIN

  #-------------------------------------------------------------
  # Arithmetic tests
  #-------------------------------------------------------------
  TEST_UIMM5_UIMM5_OP( 2, p.bset, 0b00000000000000000000000000000001, 0b00000000000000000000000000000000, 0, 0 )
  TEST_UIMM5_UIMM5_OP( 3, p.bset, 0b00000000000000000000000000000010, 0b00000000000000000000000000000000, 0, 1 )
  TEST_UIMM5_UIMM5_OP( 4, p.bset, 0b00000000000000000000000000000011, 0b00000000000000000000000000000000, 1, 0 )
  TEST_UIMM5_UIMM5_OP( 5, p.bset, 0b11111111111111111111111111111111, 0b00000000000000000000000000000000, 31, 0 )
  TEST_UIMM5_UIMM5_OP( 6, p.bset, 0b11111111111111111111111111111110, 0b00000000000000000000000000000000, 31, 1 )
  TEST_UIMM5_UIMM5_OP( 7, p.bset, 0b10000000000000000000000000000000, 0b00000000000000000000000000000000, 0, 31 )
  TEST_UIMM5_UIMM5_OP( 8, p.bset, 0b11000000000000000000000000000000, 0b00000000000000000000000000000000, 31, 30 )
  TEST_UIMM5_UIMM5_OP( 9, p.bset, 0b10000000000000000000000000000000, 0b00000000000000000000000000000000, 31, 31 )
  TEST_UIMM5_UIMM5_OP( 10, p.bset, 0b11111111111111111111111111111011, 0b00100111000011000011011001111011, 27, 6 )
  TEST_UIMM5_UIMM5_OP( 11, p.bset, 0b11011111111111111111111111111111, 0b11010111011100110111010000011111, 27, 1 )
  TEST_UIMM5_UIMM5_OP( 12, p.bset, 0b11111111111110100101101111110111, 0b01110011101110100101101111110111, 13, 20 )
  TEST_UIMM5_UIMM5_OP( 13, p.bset, 0b11111111111101010111110000101111, 0b11001010110001010111110000101111, 31, 20 )
  TEST_UIMM5_UIMM5_OP( 14, p.bset, 0b01111111111111111111111111111010, 0b01110100011101110000000001110010, 24, 3 )
  TEST_UIMM5_UIMM5_OP( 15, p.bset, 0b11111000111010001110101010011110, 0b10111000111010001110101010011110, 8, 27 )
  TEST_UIMM5_UIMM5_OP( 16, p.bset, 0b11010111111111111111111111111011, 0b11010100110000100000101001000011, 22, 3 )
  TEST_UIMM5_UIMM5_OP( 17, p.bset, 0b10010000011101111111111111111010, 0b10010000011101101111001101001010, 14, 3 )
  TEST_UIMM5_UIMM5_OP( 18, p.bset, 0b11111111100010001011010000100101, 0b10100011000010001011010000100101, 12, 23 )
  TEST_UIMM5_UIMM5_OP( 19, p.bset, 0b00100011000100101000110111101111, 0b00100011000100101000110111101111, 0, 3 )
  

  #-------------------------------------------------------------
  # Source/Destination tests
  #-------------------------------------------------------------
  TEST_UIMM5_UIMM5_SRC1_EQ_DEST( 20, p.bset, 0b11110101111000010111011111110101, 0b11110101111000010111000000010101, 5, 5 )
  TEST_UIMM5_UIMM5_SRC1_EQ_DEST( 21, p.bset, 0b11111011111000101111011111101110, 0b11111011111000101111001011101110, 5, 5 )
  

  #-------------------------------------------------------------
  # Bypassing tests
  #-------------------------------------------------------------
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 22, 0, p.bset, 0b01110110011111111111111111111011, 0b01110110010111111100101110111011, 15, 6 )
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 23, 1, p.bset, 0b11101110000010111001100001010100, 0b01101110000010111001100001010100, 29, 29 )
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 24, 2, p.bset, 0b11111111111111111111111111111101, 0b01010100111011111101101110001101, 29, 4 )
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 25, 0, p.bset, 0b01111010001100101111111111111101, 0b01111010001100101111101101111101, 8, 7 )
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 26, 1, p.bset, 0b01000101110100111111111111010101, 0b01000101110100011000000110010101, 11, 6 )
  TEST_UIMM5_UIMM5_SRC1_BYPASS( 27, 2, p.bset, 0b00110011001011111000010011110001, 0b00110011001011111000010011110001, 1, 5 )
  
  TEST_UIMM5_UIMM5_DEST_BYPASS( 28, 0, p.bset, 0b11111111111111101000101011011010, 0b11011101101100101000101011011010, 19, 18 )
  TEST_UIMM5_UIMM5_DEST_BYPASS( 29, 1, p.bset, 0b00111011100101010111111100011011, 0b00111011100101010111011000011011, 6, 8 )
  TEST_UIMM5_UIMM5_DEST_BYPASS( 30, 2, p.bset, 0b11011011111111111011010100100011, 0b11011011111101000011010100100011, 10, 15 )
  TEST_UIMM5_UIMM5_DEST_BYPASS( 31, 0, p.bset, 0b11110010101110011101101001011101, 0b11110010101110011101101001011101, 5, 30 )
  TEST_UIMM5_UIMM5_DEST_BYPASS( 32, 1, p.bset, 0b11101010001111111111111111111111, 0b11101010001001010000010010010111, 18, 2 )
  TEST_UIMM5_UIMM5_DEST_BYPASS( 33, 2, p.bset, 0b01010010011111111111111111111101, 0b01010010010010010000101111100101, 20, 2 )
  
  

  TEST_UIMM5_UIMM5_ZEROSRC1( 34, p.bset, 0b11111111111111111111110000000000, 27, 10 )
  TEST_UIMM5_UIMM5_ZEROSRC1( 35, p.bset, 0b00000000000000011111111111100000, 11, 5 )
  
  TEST_UIMM5_UIMM5_ZERODEST( 36, p.bset, 0b10110011000101011110111011010000, 23, 14 )
  TEST_UIMM5_UIMM5_ZERODEST( 37, p.bset, 0b00100010110010001000000110101101, 16, 1 )
  
  

  TEST_PASSFAIL

# Input data section.
RVTEST_CODE_END

  .data

# Output data section.
RVTEST_DATA_BEGIN

  TEST_DATA

RVTEST_DATA_END
